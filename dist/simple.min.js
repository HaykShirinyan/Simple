var Simple;(function(e){function t(t){return function(n){e.Configuration.container.register(t.name,n,t.dependencies,t.singleton)}}function n(t){return function(n){n.prototype.constructor.viewName=t.name,e.Configuration.container.register(t.name,n,t.dependencies),e.Configuration.$views[t.name]=t.selector||t.name}}e.injectable=t,e.view=n})(Simple||(Simple={}));var Simple;(function(e){var t=function(){function t(){}return Object.defineProperty(t,"container",{get:function(){return t._container||(t._container=new e.ServiceContainer,t._container.addInstance("$serviceContainer",t._container)),t._container},set:function(e){if(t._container)for(var n=0,i=t._container.services;n<i.length;n++){var r=i[n];e.register(r.name,r.service,r.depencencies,r.singleton)}t._container=e},enumerable:!0,configurable:!0}),t.resolve=function(e){return t.container.get(e)},t.$views={},t}();e.Configuration=t})(Simple||(Simple={}));var Simple;(function(e){var t=function(){function e(){this.services=[],this._singletons=[]}return e.prototype.register=function(e,t,n,i){void 0===i&&(i=!1);for(var r=0;r<this.services.length;r++){var o=this.services[r];if(o.name===e)return o.service=t,o.depencencies=n||[],o.singleton=i,this.services[r]=o,t}return this.services.push({name:e,service:t,depencencies:n||[],singleton:i}),t},e.prototype.addInstance=function(e,t){return this.register(e,t,[],!0),this._singletons.push({name:e,instance:t}),t},e.prototype.getSingletonInstance=function(e){for(var t=0,n=this._singletons;t<n.length;t++){var i=n[t];if(i.name===e)return i.instance}},e.prototype.getSingleton=function(e){var t=this.getSingletonInstance(e.name);if(t)return t;var n=this.createInstance(e);return this._singletons.push({name:e.name,instance:n}),n},e.prototype.getDependencies=function(e){for(var t=[],n=0,i=e.depencencies;n<i.length;n++){var r=i[n];t.push(this.get(r))}return t},e.prototype.createInstance=function(e){var t=this.getDependencies(e),n=Object.create(e.service.prototype);return n.constructor.apply(n,t),n},e.prototype.getInstance=function(e){return e.singleton?this.getSingleton(e):this.createInstance(e)},e.prototype.get=function(e){for(var t=0,n=this.services;t<n.length;t++){var i=n[t];if(i.name===e)return this.getInstance(i)}throw new Error("Service was not found. name: "+e)},e}();e.ServiceContainer=t})(Simple||(Simple={}));var __decorate=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Simple;(function(e){var t=function(){function t(t){this.htmlService=t,this.modelWatcher=new e.Watcher(this,"model"),this.viewDataWatcher=new e.Watcher(this,"viewData")}return t.prototype.setPath=function(e,t,n){for(var i=t.split("."),r=0;r<i.length-1;r++)e=e[i[r]]||{};return e[i[i.length-1]]=n,e},t.prototype.initializeContext=function(e,t){this.model=t},t.viewName="simple-view",t=__decorate([e.view({name:"simple-view"})],t)}();e.View=t})(Simple||(Simple={}));var Simple;(function(e){var t=function(){function e(e,t){this.parent=e,this.objectGraph={},this.valueChangedEvents={};var n=e[t];this.bind(e,t,t),n&&this.set(e,n,t,t,!0)}return e.prototype.watch=function(e,t){Array.isArray(this.valueChangedEvents[e])||(this.valueChangedEvents[e]=[]),this.valueChangedEvents[e].push(t)},e.prototype.valueChanged=function(e,t,n){var i=this.valueChangedEvents[e];if(i)for(var r=0,o=i;r<o.length;r++){var s=o[r];s&&s(t,n)}},e.prototype.canUpdate=function(e,t,n){return!!e||t!==n},e.prototype.isObject=function(e){return!(!e||"function"==typeof e||"string"==typeof e||!Object.keys(e)||Array.isArray(e))},e.prototype.setObject=function(e,t,n,i){for(var r in t)if(t.hasOwnProperty(r)){var o=i+"."+r;this.bind(e[n],r,o),this.set(e[n],t[r],r,o,!0)}},e.prototype.resetObject=function(e){var t=".";for(var n in this.objectGraph)if(0===n.indexOf(t)&&n.length>e.length){var i=this.objectGraph[n],r=void 0;delete this.objectGraph[n],this.valueChanged(e,i,r)}},e.prototype.schedule=function(e,t,n){var i=this,r=Object.keys(e).length,o=window.setTimeout(function(){if(r!==Object.keys(e).length)for(var t in e)if(e.hasOwnProperty(t)&&!Object.getOwnPropertyDescriptor(e,t).get){var s=n+"."+t,a=e[t];e[t]=void 0,i.bind(e,t,s),i.set(e,a,t,s,!0)}window.clearTimeout(o)},1)},e.prototype.extendArrayMethods=function(e,t){for(var n=this,i=e.slice(),r=["push","pop","shift","unshift","splice","sort","reverse"],o=function(r){var o=e[r];Object.defineProperty(e,r,{configurable:!1,enumerable:!1,value:function(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];var c=o.apply(e,s);return n.valueChanged(t,i,e),i[r].apply(i,s),c}})},s=0,a=r;s<a.length;s++){var c=a[s];o(c)}},e.prototype.setArray=function(e,t,n,i){this.extendArrayMethods(t,i);for(var r=0;r<t.length;r++){var o=t[r],s=i+"["+r+"]";this.bind(e[n],r,s),this.set(e[n],o,r,s,!0);for(var a in o)if(o.hasOwnProperty(a)){var c=i+"["+r+"]."+a;this.bind(e[n][r],a,c),this.set(e[n][r][a],o[a],a,c,!0)}}return t},e.prototype.set=function(e,t,n,i,r){void 0===r&&(r=!1);var o=this.objectGraph[i],s=this.isObject(o);this.canUpdate(r,o,t)&&(this.objectGraph[i]=t,this.valueChanged(i,o,t),this.isObject(t)?this.setObject(e,t,n,i):s?this.resetObject(i):Array.isArray(t)&&(this.objectGraph[i]=this.setArray(e,t,n,i)))},e.prototype.get=function(e,t){var n=this.objectGraph[t];return this.isObject(n)&&this.schedule(n,e,t),n},e.prototype.bind=function(e,t,n){var i=this;n in this.objectGraph||(this.objectGraph[n]=e[t]),Object.defineProperty(e,t,{enumerable:!0,configurable:!0,get:function(){return i.get(t,n)},set:function(r){i.set(e,r,t,n)}})},e}();e.Watcher=t})(Simple||(Simple={}));var Simple;(function(e){var t;(function(t){var n;(function(t){(function(){function t(e,t){this._htmlService=e,this._serviceContainer=t}return t.prototype.renderView=function(t){for(var n in e.Configuration.$views){var i=this._htmlService.select(e.Configuration.$views[n]);if(i){var r=this._serviceContainer.get(n);r.initializeContext(i,t)}}},t=__decorate([e.injectable({name:"$viewEngine",singleton:!0,dependencies:["$htmlService","$serviceContainer"]})],t)})()})(n=t.Concrete||(t.Concrete={}))})(t=e.Rendering||(e.Rendering={}))})(Simple||(Simple={}));var Simple;(function(e){var t;(function(t){var n;(function(t){var n=function(){function t(e){this.htmlService=e}return t.prototype.setPath=function(e,t,n){for(var i=t.split("."),r=0;r<i.length-1;r++)e[i[r]]||(e[i[r]]={}),e=e[i[r]]||{};e[i[i.length-1]]=n},t.prototype.initializeContext=function(e,t){var n=this.htmlService.selectAll("[simple-bind]",e);t.model=t.model||{},t.viewData=t.viewData||{};for(var i=function(e){var i=n[e],o=i.getAttribute("simple-bind");0===o.indexOf("model.")?(t.modelWatcher.watch(o,function(e,t){i.textContent=t}),r.setPath(t.model,o.substring("model.".length),i.textContent)):0===o.indexOf("viewData.")&&(t.viewDataWatcher.watch(o,function(e,t){i.textContent=t}),r.setPath(t.viewData,o.substring("viewData.".length),i.textContent))},r=this,o=0;o<n.length;o++)i(o)},t=__decorate([e.view({name:"simple-bind",selector:"[simple-bind]:not([simple-repeat] [simple-bind])"})],t)}();t.SimpleBind=n})(n=t.Views||(t.Views={}))})(t=e.Rendering||(e.Rendering={}))})(Simple||(Simple={}));var Simple;(function(e){var t;(function(t){var n;(function(t){var n=function(){function t(){this._document=document,this._window=window}return t.prototype.ready=function(e){(this._document.attachEvent?"complete"===this._document.readyState:"loading"!==this._document.readyState)?e():this._document.addEventListener("DOMContentLoaded",e)},t.prototype.addEventListener=function(e,t){this._window.addEventListener(e,t)},t.prototype.select=function(e,t){return t?t.querySelector(e):this._document.querySelector(e)},t.prototype.selectAll=function(e,t){return t?t.querySelectorAll(e):this._document.querySelectorAll(e)},t.prototype.craeteElement=function(e){return this._document.createElement(e)},t=__decorate([e.injectable({name:"$htmlService"})],t)}();t.HtmlService=n})(n=t.Concrete||(t.Concrete={}))})(t=e.Services||(e.Services={}))})(Simple||(Simple={}));var Simple;(function(e){var t;(function(t){var n;(function(t){var n=function(){function t(){}return t.prototype.parseResponse=function(e){return e?JSON.parse(e):e},t.prototype.success=function(e){return{statusCode:e.status,data:this.parseResponse(e.responseText)}},t.prototype.fail=function(e){return{statusCode:e.status,data:this.parseResponse(e.responseText)}},t.prototype.get=function(e){var t=this;return new Promise(function(e,n){var i=new XMLHttpRequest;i.open("GET","/my/url",!0),i.onload=function(){i.status>=200&&i.status<400?e(t.success(i)):n(t.fail(i))},i.onerror=function(){n(t.fail(i))},i.send()})},t=__decorate([e.injectable({name:"$httpService"})],t)}();t.HttpService=n})(n=t.Concrete||(t.Concrete={}))})(t=e.Services||(e.Services={}))})(Simple||(Simple={}));